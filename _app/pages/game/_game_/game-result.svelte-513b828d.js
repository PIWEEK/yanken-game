import{S as oe,i as le,s as ce,j as O,m as q,o as G,x as j,u as V,v as R,$ as U,e as k,t as z,k as C,c as I,a as b,g as A,d as _,n as P,b as E,f as ie,E as g,a2 as ue,r as fe,w as me,a5 as de}from"../../../chunks/vendor-06d4fd3a.js";import{g as ge}from"../../../chunks/navigation-51f4a605.js";import{s as pe}from"../../../chunks/store-9ef01361.js";import{J as ve,a as he}from"../../../chunks/websockets-89f6f0ce.js";import{M as _e}from"../../../chunks/MenuContainer-519bd293.js";import{P as Y}from"../../../chunks/PlayerCard-e28a99bc.js";import"../../../chunks/singletons-12a22614.js";function ne(r,e,s){const t=r.slice();return t[10]=e[s],t}function ae(r){var t,c;let e,s;return e=new Y({props:{cardType:"small",name:(t=r[10])==null?void 0:t.name,avatar:(c=r[10])==null?void 0:c.avatar}}),{c(){O(e.$$.fragment)},l(a){q(e.$$.fragment,a)},m(a,f){G(e,a,f),s=!0},p(a,f){var p,h;const o={};f&4&&(o.name=(p=a[10])==null?void 0:p.name),f&4&&(o.avatar=(h=a[10])==null?void 0:h.avatar),e.$set(o)},i(a){s||(j(e.$$.fragment,a),s=!0)},o(a){V(e.$$.fragment,a),s=!1},d(a){R(e,a)}}}function $e(r){var F,x,ee,te;let e,s,t,c,a,f,o,p,h,B,v,T,i,H,K,$,L,w,Q,W,X,Z;f=new Y({props:{cardType:"full",name:(F=r[0])==null?void 0:F.name,avatar:(x=r[0])==null?void 0:x.avatar}}),v=new Y({props:{cardType:"full",name:(ee=r[1])==null?void 0:ee.name,avatar:(te=r[1])==null?void 0:te.avatar}});let y=r[2],l=[];for(let n=0;n<y.length;n+=1)l[n]=ae(ne(r,y,n));const re=n=>V(l[n],1,1,()=>{l[n]=null});return{c(){e=k("div"),s=k("div"),t=k("div"),c=z("Winner"),a=C(),O(f.$$.fragment),o=C(),p=k("div"),h=z("Not winner"),B=C(),O(v.$$.fragment),T=C(),i=k("div"),H=z("Bunch of losers"),K=C(),$=k("div");for(let n=0;n<l.length;n+=1)l[n].c();L=C(),w=k("button"),Q=z("Play again"),this.h()},l(n){e=I(n,"DIV",{class:!0});var u=b(e);s=I(u,"DIV",{class:!0});var m=b(s);t=I(m,"DIV",{class:!0});var D=b(t);c=A(D,"Winner"),D.forEach(_),a=P(m),q(f.$$.fragment,m),o=P(m),p=I(m,"DIV",{class:!0});var J=b(p);h=A(J,"Not winner"),J.forEach(_),B=P(m),q(v.$$.fragment,m),T=P(m),i=I(m,"DIV",{class:!0});var M=b(i);H=A(M,"Bunch of losers"),M.forEach(_),K=P(m),$=I(m,"DIV",{class:!0});var N=b($);for(let d=0;d<l.length;d+=1)l[d].l(N);N.forEach(_),m.forEach(_),L=P(u),w=I(u,"BUTTON",{class:!0});var S=b(w);Q=A(S,"Play again"),S.forEach(_),u.forEach(_),this.h()},h(){E(t,"class","message svelte-aj82gr"),E(p,"class","message svelte-aj82gr"),E(i,"class","message svelte-aj82gr"),E($,"class","players svelte-aj82gr"),E(s,"class","results svelte-aj82gr"),E(w,"class","svelte-aj82gr"),E(e,"class","container svelte-aj82gr")},m(n,u){ie(n,e,u),g(e,s),g(s,t),g(t,c),g(s,a),G(f,s,null),g(s,o),g(s,p),g(p,h),g(s,B),G(v,s,null),g(s,T),g(s,i),g(i,H),g(s,K),g(s,$);for(let m=0;m<l.length;m+=1)l[m].m($,null);g(e,L),g(e,w),g(w,Q),W=!0,X||(Z=ue(w,"click",r[7]),X=!0)},p(n,u){var J,M,N,S;const m={};u&1&&(m.name=(J=n[0])==null?void 0:J.name),u&1&&(m.avatar=(M=n[0])==null?void 0:M.avatar),f.$set(m);const D={};if(u&2&&(D.name=(N=n[1])==null?void 0:N.name),u&2&&(D.avatar=(S=n[1])==null?void 0:S.avatar),v.$set(D),u&4){y=n[2];let d;for(d=0;d<y.length;d+=1){const se=ne(n,y,d);l[d]?(l[d].p(se,u),j(l[d],1)):(l[d]=ae(se),l[d].c(),j(l[d],1),l[d].m($,null))}for(fe(),d=y.length;d<l.length;d+=1)re(d);me()}},i(n){if(!W){j(f.$$.fragment,n),j(v.$$.fragment,n);for(let u=0;u<y.length;u+=1)j(l[u]);W=!0}},o(n){V(f.$$.fragment,n),V(v.$$.fragment,n),l=l.filter(Boolean);for(let u=0;u<l.length;u+=1)V(l[u]);W=!1},d(n){n&&_(e),R(f),R(v),de(l,n),X=!1,Z()}}}function we(r){let e,s;return e=new _e({props:{$$slots:{default:[$e]},$$scope:{ctx:r}}}),{c(){O(e.$$.fragment)},l(t){q(e.$$.fragment,t)},m(t,c){G(e,t,c),s=!0},p(t,[c]){const a={};c&8199&&(a.$$scope={dirty:c,ctx:t}),e.$set(a)},i(t){s||(j(e.$$.fragment,t),s=!0)},o(t){V(e.$$.fragment,t),s=!1},d(t){R(e,t)}}}function ye(r){const e=r.room,s=e==null?void 0:e.sessions,t=e==null?void 0:e.results[0][0],c=t==null?void 0:t.winner;return!c||!s?null:s[c]}function je(r){var f;const e=r.room,s=e==null?void 0:e.sessions,t=e==null?void 0:e.results[0][0],c=t==null?void 0:t.winner,a=(f=t==null?void 0:t.players)==null?void 0:f.find(o=>o!==c);return!s||!a?null:s[a]}function ke(r){const e=r.room;if(!e)return[];const s=e.sessions,t=e.results[0][0],c=t.winner,a=t.players.find(o=>o!==c);return e.players.filter(o=>o!==c&&o!==a).map(o=>s[o])}function Ie(r,e,s){let t,c,a,f;const o=pe.get(),p=o.select(i=>i.room);U(r,p,i=>s(8,t=i));const h=o.select(ye);U(r,h,i=>s(0,c=i));const B=o.select(je);U(r,B,i=>s(1,a=i));const v=o.select(ke);U(r,v,i=>s(2,f=i));function T(){const i=t==null?void 0:t.id;!i||(o.emit(new ve(i)),o.emit(new he(i)),ge(`/game/${i}/wait-players`))}return[c,a,f,p,h,B,v,T]}class Te extends oe{constructor(e){super();le(this,e,Ie,we,ce,{})}}export{Te as default};
